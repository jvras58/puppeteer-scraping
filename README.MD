# ğŸ¯ # Puppeteer - Scrapping

<div align="center">

[![Node.js](https://img.shields.io/badge/Node.js-20.x-green?logo=node.js)](https://nodejs.org/)
[![TypeScript](https://img.shields.io/badge/TypeScript-5.x-blue?logo=typescript)](https://www.typescriptlang.org/)
[![Puppeteer](https://img.shields.io/badge/Puppeteer-24.x-orange?logo=puppeteer)](https://pptr.dev/)
[![Docker](https://img.shields.io/badge/Docker-Ready-blue?logo=docker)](https://www.docker.com/)
[![pnpm](https://img.shields.io/badge/pnpm-9.x-yellow?logo=pnpm)](https://pnpm.io/)

*AutomaÃ§Ã£o inteligente para captura utilizando Puppeteer*

</div>

## ğŸ“– Sobre o Projeto

Este projeto demonstra como utilizar o **Puppeteer** para automaÃ§Ã£o web, especificamente focado em:

- ğŸ“ **Captura automatizada de sessÃ£o do SIGAA** (Sistema Integrado de GestÃ£o de Atividades AcadÃªmicas)
- ğŸ“¸ **Screenshots automÃ¡ticos** de pÃ¡ginas importantes
- ğŸ” **Login automatizado** com credenciais configurÃ¡veis
- ğŸ“Š **Coleta de dados acadÃªmicos** de forma programÃ¡tica
- ğŸ³ **ContainerizaÃ§Ã£o completa** com Docker para ambientes isolados

### âœ¨ Funcionalidades

- âœ… NavegaÃ§Ã£o automatizada no SIGAA
- âœ… Captura de tela da pÃ¡gina de login
- âœ… Login automÃ¡tico com credenciais
- âœ… Captura de tela pÃ³s-login
- âœ… Logs estruturados com timestamps
- âœ… Gerenciamento de arquivos e screenshots
- âœ… ExecuÃ§Ã£o em container Docker isolado

## ğŸš€ Tecnologias e Ferramentas

### ğŸ”§ Stack Principal

| Categoria | Tecnologia | VersÃ£o | DescriÃ§Ã£o |
|-----------|------------|--------|-----------|
| **Runtime** | Node.js | v20.x | Ambiente de execuÃ§Ã£o JavaScript |
| **Linguagem** | TypeScript | 5.x | Tipagem estÃ¡tica para JavaScript |
| **AutomaÃ§Ã£o** | Puppeteer | 24.x | Controle programÃ¡tico do navegador |
| **ContainerizaÃ§Ã£o** | Docker | Latest | Isolamento e portabilidade |
| **Gerenciador** | pnpm | 9.x | Gerenciamento eficiente de pacotes |

### ğŸ“¦ DependÃªncias

```json
{
  "dependencies": {
    "puppeteer": "24.22.0"
  },
  "devDependencies": {
    "@types/node": "^24.5.2",
    "tsx": "^4.20.5",
    "typescript": "^5.9.2"
  }
}
```

## ğŸ“ Estrutura do Projeto

```
captura_session_sigaa_pup/
â”œâ”€ğŸ“ src/                          # CÃ³digo fonte principal
â”‚   â”œâ”€ï¿½ index.ts                  # Ponto de entrada da aplicaÃ§Ã£o
â”‚   â”œâ”€ğŸ“ config/                   # ConfiguraÃ§Ãµes
â”‚   â”‚   â”œâ”€ğŸ“„ browser.ts            # ConfiguraÃ§Ãµes do navegador Puppeteer
â”‚   â”‚   â””â”€ğŸ“„ config.ts             # ConfiguraÃ§Ãµes gerais da aplicaÃ§Ã£o
â”‚   â”œâ”€ğŸ“ scraping/                 # MÃ³dulos de scraping
â”‚   â”‚   â””â”€ğŸ“„ scraper.ts            # FunÃ§Ãµes especÃ­ficas do SIGAA
â”‚   â””â”€ğŸ“ utils/                    # UtilitÃ¡rios
â”‚       â”œâ”€ğŸ“„ fileManager.ts        # Gerenciamento de arquivos e screenshots
â”‚       â””â”€ğŸ“„ logger.ts             # Sistema de logs estruturado
â”œâ”€ğŸ“ docs/                         # DocumentaÃ§Ã£o
â”‚   â”œâ”€ğŸ“„ CHECKLIST.MD              # Lista de verificaÃ§Ã£o do projeto
â”‚   â””â”€ğŸ“„ commands.md               # Comandos Docker Ãºteis
â”œâ”€ğŸ“ output/                       # Screenshots e arquivos gerados
â”œâ”€ğŸ“ logs/                         # Logs da aplicaÃ§Ã£o
â”œâ”€ğŸ“„ Dockerfile                    # ConfiguraÃ§Ã£o multi-stage do container
â”œâ”€ğŸ“„ compose.yml                   # OrquestraÃ§Ã£o Docker Compose
â”œâ”€ğŸ“„ makefile                      # AutomaÃ§Ã£o de tarefas
â”œâ”€ğŸ“„ package.json                  # ConfiguraÃ§Ãµes e dependÃªncias
â”œâ”€ğŸ“„ tsconfig.json                 # ConfiguraÃ§Ãµes TypeScript
â””â”€ğŸ“„ README.md                     # Este arquivo
```

## âš¡ InÃ­cio RÃ¡pido

### ğŸ³ Usando Docker (Recomendado)

```bash
# Clone o repositÃ³rio
git clone https://github.com/jvras58/captura_session_sigaa_pup.git
cd captura_session_sigaa_pup

# Execute com Docker Compose
make scraping-docker

# Ou manualmente
docker-compose up --build
```

### ğŸ’» Desenvolvimento Local

```bash
# Clone o repositÃ³rio
git clone https://github.com/jvras58/captura_session_sigaa_pup.git
cd captura_session_sigaa_pup

# Instale as dependÃªncias
pnpm install

# Execute em modo desenvolvimento
make scraping-dev

# Ou manualmente
pnpm run dev
```

## ğŸ› ï¸ Comandos DisponÃ­veis

### ğŸ“‹ Makefile

| Comando | DescriÃ§Ã£o |
|---------|-----------|
| `make scraping-dev` | Executa o scraper em modo desenvolvimento |
| `make scraping-docker` | Executa o scraper em container Docker |
| `make logs` | Exibe logs do container |
| `make clean` | Limpa containers, volumes e arquivos temporÃ¡rios |
| `make help` | Exibe todos os comandos disponÃ­veis |

### ğŸ³ Docker Compose

```bash
# ProduÃ§Ã£o
docker-compose up --build

# Desenvolvimento (com hot reload)
docker-compose --profile dev up --build

# Background
docker-compose up -d --build

# Logs em tempo real
docker-compose logs -f sigaa-scraper

# Limpeza completa
docker-compose down -v --rmi all
```

### ğŸ“¦ pnpm Scripts

```bash
pnpm run dev     # Desenvolvimento com tsx
pnpm run build   # Compilar TypeScript
pnpm run start   # Executar versÃ£o compilada
```

## ğŸ—ï¸ ConfiguraÃ§Ã£o do Ambiente

### ğŸ”§ VariÃ¡veis de Ambiente

Crie um arquivo `.env` na raiz do projeto:

```env
# ConfiguraÃ§Ãµes da aplicaÃ§Ã£o
NODE_ENV=production
HEADLESS=true

# ConfiguraÃ§Ãµes do Puppeteer
PUPPETEER_EXECUTABLE_PATH=/usr/bin/chromium
CHROME_BIN=/usr/bin/chromium
CHROME_PATH=/usr/lib/chromium/
PUPPETEER_SKIP_CHROMIUM_DOWNLOAD=true
PUPPETEER_PRODUCT=chrome
CHROMIUM_FLAGS=--disable-software-rasterizer --disable-dev-shm-usage

# Credenciais SIGAA (configure conforme necessÃ¡rio)
SIGAA_USERNAME=seu_usuario
SIGAA_PASSWORD=sua_senha
```

### ğŸ³ Docker Multi-Stage Build

O projeto utiliza **multi-stage build** para otimizaÃ§Ã£o:

- **Stage 1 (builder)**: Instala dependÃªncias completas e compila TypeScript
- **Stage 2 (production)**: Imagem final otimizada apenas com runtime

## ğŸ”§ Desenvolvimento

### ğŸ“‹ PrÃ©-requisitos

- **Node.js** 20.x ou superior
- **pnpm** 9.x ou superior
- **Docker** (opcional, mas recomendado)
- **Git** para controle de versÃ£o

### ğŸƒâ€â™‚ï¸ Executando Localmente

1. **Clone e instale dependÃªncias:**
   ```bash
   git clone <repo-url>
   cd captura_session_sigaa_pup
   pnpm install
   ```

2. **Configure as credenciais** em `src/index.ts` ou variÃ¡veis de ambiente

3. **Execute em desenvolvimento:**
   ```bash
   pnpm run dev
   ```

### ï¿½ Desenvolvimento com Docker

```bash
# Modo desenvolvimento com hot reload
docker-compose --profile dev up --build

# Debug dentro do container
docker-compose exec sigaa-scraper bash
```

## ğŸ“¸ SaÃ­das do Sistema

### ğŸ–¼ï¸ Screenshots Gerados

- `sigaa_login_inicial.png` - PÃ¡gina de login antes da autenticaÃ§Ã£o
- `sigaa_tela_inicial.png` - Tela inicial apÃ³s login bem-sucedido

### ğŸ“ Logs

Os logs sÃ£o estruturados e incluem:
- Timestamps precisos
- NÃ­veis de log (INFO, ERROR)
- Mensagens descritivas das aÃ§Ãµes

## ğŸš¨ SoluÃ§Ã£o de Problemas

### âŒ Erro: `tsc: not found`
```bash
# Reconstrua com cache limpo
docker-compose build --no-cache
```

### âŒ Erro: `pnpm-lock.yaml` issues
```bash
# Limpe e reinstale dependÃªncias
rm -rf node_modules pnpm-lock.yaml
pnpm install
docker-compose build --no-cache
```

### âŒ Container nÃ£o inicia
```bash
# Verifique logs detalhados
docker-compose logs -f sigaa-scraper

# Limpe recursos Docker
make clean
```

## ğŸ›¡ï¸ SeguranÃ§a

âš ï¸ **IMPORTANTE**: Este projeto Ã© apenas para fins educacionais e de demonstraÃ§Ã£o.

- ğŸ” **Nunca commite credenciais** no cÃ³digo
- ğŸ”’ Use variÃ¡veis de ambiente para dados sensÃ­veis
- âš–ï¸ Respeite os termos de uso dos sistemas automatizados
- ğŸ¤– Implemente rate limiting em ambientes de produÃ§Ã£o

## ğŸ¤ ContribuiÃ§Ã£o

1. Fork o projeto
2. Crie uma branch para sua feature (`git checkout -b feature/AmazingFeature`)
3. Commit suas mudanÃ§as (`git commit -m 'Add some AmazingFeature'`)
4. Push para a branch (`git push origin feature/AmazingFeature`)
5. Abra um Pull Request

## ğŸ“„ LicenÃ§a

Este projeto estÃ¡ sob a licenÃ§a ISC. Veja o arquivo `LICENSE` para mais detalhes.

## ğŸ‘¥ Autor

**jvras58** - [GitHub](https://github.com/jvras58)

---

<div align="center">

**â­ Se este projeto foi Ãºtil para vocÃª, deixe uma estrela!**

[ğŸ› Reportar Bug](https://github.com/jvras58/captura_session_sigaa_pup/issues) â€¢ [âœ¨ Solicitar Feature](https://github.com/jvras58/captura_session_sigaa_pup/issues) â€¢ [ğŸ“– DocumentaÃ§Ã£o](./docs/)

</div>

